%-------------------------------------------------------------------------------
\subsubsection{Chémostat}
%-------------------------------------------------------------------------------

% Voir \url{https://umr5558-shiny.univ-lyon1.fr/web/}

On considère le modèle du chemostat qui décrit l'évolution d'une population bactérienne au cours du temps dans un milieu alimenté par un flux constant de nutriment. 
Plus précisément, la population bactérienne se développe dans une enceinte close alimentée d'un côté par un flux constant de nutriments et dont les nutriments peuvent également s'évacuer à proportion de leur quantité.

On note
\begin{itemize}
  \item $x(t)$ la taille de la population bactérienne au temps $t$ et
  \item $y(t)$ la quantité de nutriments présente dans le milieu au temps $t$.
\end{itemize}
Après simplification, le système différentiel contrôlant l'évolution de ces deux variables au cours du temps peut s'écrire
$$
\left\{
  \dot x = \displaystyle{\frac{a x y}{1 + y} - x}, 
  \qquad
  \dot y = \displaystyle{- \frac{x y}{1 + y} - y + b}
\right\}
$$
où on suppose que les paramètres $a$ et $b$ sont positifs ou nuls : $a, b \geq 0$.

\bigskip
\begin{enumerate}
  \item Interpréter les différents termes de ce modèle ainsi que ses paramètres.
  \solution{
    \begin{itemize}
     \item[$\dot x$ :] 
     Quand la quantité de nutriment tend vers l'infini ($y \to \infty$), on a $\dot x = (a-1) x$. $a - 1$ représente donc le taux de croissance de la population bactérienne en l'absence de contrainte de ressource. \\
     Le terme $y/(1+y)$ fait que le taux de croissance de la population n'est pas directement proportionnel à la quantité de nutriment, mais seulement une fonction croissante de cette quantité qui va 0 (pour $y = 0$) à 1 (quand $y \to \infty$). \\
     Le terme $-x$ décrit la décroissance (exponentielle) de la population en l'absence de nutriments.
     \item[$\dot y$ :] 
     Le terme $- x y / (1+y)$ décrit la consommation des nutriments par les bactéries. Le terme $- y$ décrit leur évacuation (à vitesse proportionnelle à leur quantité). \\
     $b$ est le seul terme positif, qui décrit l'apport constant de nutriments dans le système.
    \end{itemize}
  }
  %
  \item Montrer que les points stationnaires du système sont.
  $$
  A = (0, b) \qquad \text{et} \qquad B = \left(ab - \frac{a}{a - 1}, \frac1{a - 1}\right).
  $$
  \solution{
  On annule simultanément $F_1(x, y) = xy/(1+y) - x$ et $F_2(x, y) = -xy/(1+y) -y +b$. 
  \begin{itemize}
   \item $F_1(x, y)$ est nul pour $x = 0$ et $y = 1 / (a-1)$. 
   \item $F_2(x, y)$ est nul ssi $xy = (1+y)(b-y)$. Si $x = 0$ alors $(1+y)(b-y)$ doit être nul, ce qui impose $y = b$, ce qui donne le point $A$. Si $x > 0$, alors $y = 1 / (a-1)$ (puisque $F_1(x, y)$ doit être nul) et donc
   $$
   \frac{x}{a - 1} 
   = \frac{a}{a - 1} \left(b - \frac1{a - 1}\right)
   = ab - \frac{a}{a - 1},
   $$
   ce qui donne le point $B$.
  \end{itemize}
  }
  %
  \item \label{q:chemostatDistincts} Donner les conditions sur $a$ et $b$ qui assurent que les deux équilibres correspondent à des états distincts et biologiquement raisonnables (c'est-à-dire $x$ et $y$ positifs ou nuls). 
  \solution{
    Les coordonnées de $B$ sont positives et finies si $a > 1$ et $b(a-1) \geq  1$.
    Sous ces conditions, les coordonnées de $A$ sont également positives et finies. \\
    On remarque de plus que $A = B$ pour $b(a-1) =  1$. Pour satisfaire les deux conditions, il faut donc que
    $$
    \{a > 1 \quad \text{et} \quad b(a-1) > 1\}
    \qquad \text{et} \qquad 
    \{a > 1 \quad \text{et} \quad b > 0\}.
    $$
    }
  \item Déterminer la matrice jacobienne du système.
  \solution{
    Puisque la dérivée de $y/(1+y)$ est $1/(1+y)^2$, on a
    $$
    J_{x, y} = \left(\begin{array}{cc}
              \displaystyle{\frac{ay}{1+y} - 1} & \displaystyle{\frac{ax}{(1+y)^2}} \\
              \displaystyle{-\frac{y}{1+y}} & \displaystyle{-\frac{x}{(1+y)^2} - 1} 
        \end{array}\right).
    $$
  }
  \item \'Etudier la stabilité de chacun des points d'équilibre en supposant que les conditions établies à la question \ref{q:chemostatDistincts} sont vérifiées.
  \solution{
  \begin{description}
    \item[$A = (0, b)$ :] La jacobienne vaut alors
    $$
    J_A = \left(\begin{array}{cc}
                \displaystyle{\frac{ab}{1+b} - 1} & \displaystyle{0} \\
                \displaystyle{-\frac{b}{1+b}} & \displaystyle{- 1} 
          \end{array}\right).
    $$
    avec 
%     \begin{align*}
%       \tr(J_A) & = \frac{ab}{1+b} - 2 = \frac{}{1+b}, \\
%       \det(J_A) & = 1 - \frac{ab}{1+b} = \frac{1 - b(a-1)}{1+b} \leq 0
%     \end{align*}
    $$
    \det(J_A) = 1 - \frac{ab}{1+b} = \frac{1 - b(a-1)}{1+b} < 0
    $$
    du fait des conditions imposées aux paramètres $a$ et $b$. Les deux valeurs propres de $J_A$ sont donc de signes opposés : $A$ est un équilibre instable.
    \item[$B = (x^* = ab - a/(1-a), y^* = 1/(1-a))$ :] La jacobienne vaut alors
    $$
    J_B = \left(\begin{array}{cc}
                \displaystyle{0} & \displaystyle{\frac{ax^*}{(1+y^*)^2}} \\
                \displaystyle{-\frac1a} & \displaystyle{-\frac{x^*}{(1+y^*)^2} - 1} 
          \end{array}\right).
    $$
    avec 
    \begin{align*}
      \tr(J_B) & = -\frac{x^*}{(1+y^*)^2} - 1 < 0, &
      \det(J_B) & =  \frac{x^*}{(1+y^*)^2} >  0.
    \end{align*}
    Les deux valeurs propres de $J_B$ sont donc de même signe (car $\det(J_B) > 0$) et sont négatives (car $\tr(J_B) < 0$) : $B$ est un équilibre stable.
  \end{description}
  }
\end{enumerate}
