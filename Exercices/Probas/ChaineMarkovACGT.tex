\newcommand{\att}{\tt a}
\newcommand{\ctt}{\tt c}
\newcommand{\gtt}{\tt g}
\newcommand{\ttt}{\tt t}

%-------------------------------------------------------------------------------
\subsubsection{Chaîne de Markov sur $\{\att, \ctt, \gtt, \ttt\}$}
%-------------------------------------------------------------------------------

% Exo AL : examen 2025-26

On considère une chaîne de Markov $X=(X_n, n\in \Nbb)$ à valeurs dans $\Ecal = \{\att, \ttt, \gtt, \ctt\}$. Pour $i,j\in \Ecal$, on note $p_{ij}$ la probabilité de transition de $i$ vers $j$ et on suppose que $p_{ij}\not=0$ dès que $i\not=j$.

\begin{enumerate}
  \item Quelles sont les classes de communication de la chaîne de Markov $X$ ? Comment appelle-t-on une telle chaîne ?
  %
  \item Soit $u$ une probabilité stationnaire de $P$. Rappeler l'équation vérifiée par $u$ et $P$. Que dire au sujet de l'unicité de $u$ ?
  \solution{$uP=u$, unique à un scalaire multiplicatif près, donc unique si proba.}
  %
  \item On suppose que $p_{ij}=1/4$ pour tous $i,j$. On appelle $M$ la matrice $4\times 4$ qui ne contient que des 1.
  \begin{enumerate}
  \item Exprimer $P$, puis $P^n$ à l'aide de $M$. 
  \solution{Réponse : $P^n=(1/4)M$}
  %
  \item Déterminer $u$.
  \solution{Par symétrie, $u = (1/4) \; [1 \; 1 \; 1 \; 1]^\top$.}
  %
  \end{enumerate}
  %
  \item On suppose que $p_{ij}=1/3$ si $i\not=j$.
  \begin{enumerate}
    \item Que vaut $p_{ii}$ ? Exprimer $P$ à l'aide de $M$ et de la matrice identité $I$.
    \solution{Réponse : $P=(1/3)(M-I)$}
    %
    \item Calculer $P^n$ et montrer que $P^n$ converge vers une matrice que l'on précisera.
    \solution{
    \begin{align*}
      P^n & =(1/3)^n (M-I)^n = (1/3)^n\sum_k {n\choose k} M^k(-1)^{n-k} \\
      & = (1/3)^n \left[ \sum_{k>0} {n\choose k} 4^{k-1}(-1)^{n-k}M+(-1)^n I \right] \\
      & = (1/3)^n \left[ (1/4)\sum_k {n\choose k} 4^k(-1)^{n-k}M - (-1)^n(1/4)M+(-1)^n I\right] \\
      & = (1/4)[M-(-1/3)^n(M-4I)],
    \end{align*}
    qui tend vers M/4
    }
    %
    \item Que vaut $u$ ?
    \solution{Il faut résoudre $(1/3)(M - I) u = u$, qui donne $x = y = z = t$, soir de nouveau $u = (1/4) \; [1 \; 1 \; 1 \; 1]^\top$.}
    %
  \end{enumerate}
  \item Comment pourriez-vous généraliser le résultat des questions 2 et 3 ?
  \solution{Si les probabilité des mutations sont égales entre elles ($p_{ij} = a$ si $i \neq j$) et si les probabilités de non-mutation également ($p_{ii} = b$ pour tout $i$), alors la distribution stationnaire $u$ est uniforme.}
  %
  \item On suppose encore que $p_{ii}=0$ mais maintenant $p_{\att\gtt}=p_{\gtt\att}=p_{\ctt\ttt}=p_{\ttt\ctt}=p$ et $p_{\att\ctt}=p_{\ctt\att}=p_{\gtt\ttt}=p_{\ttt\gtt}=p_{\gtt\ctt}=p_{\ctt\gtt}=p_{\att\ttt}=p_{\ttt\att}=q$. \\
  {\sl Note : en génomique évolutive, ces deux types de mutation portent un nom (transitions et transversions).}
  \begin{enumerate}
  \item Faire un schéma. Ecrire la matrice $P$ en fonction de $p$ et $q$. Donner une relation entre $p$ et $q$. 
  \solution{$p+2q = 1$.}
  %
  \item Montrer que l'on peut réduire l'étude de cette chaîne de Markov à celle d'une chaîne de Markov à deux états. 
  \solution{purines = {\att,\gtt} et pyrimidines = {\ctt,\ttt}}
  %
  \item En déduire $u$. 
  \solution{Par symétrie la proba des purines et des pyrimidines est la même (1/2,1/2). Par symétrie, à l'intérieur de chaque classe, le poids de chaque base est le même. \\ Conclusion : $u$ est uniforme.}
  \end{enumerate}
  %
  \item On considère une chaîne de Markov $(X,Y,Z)$ à valeurs dans $E^3$. Soit $f$ la fonction qui à un triplet de bases associe l'acide aminé associé. Est-ce-que $f(X,Y,Z)$ est une chaîne de Markov ?
  \solution{Non, à cause des codons synonymes : le processus de mutation porte sur les bases, et l'acide aminé correspondant à chaque triplet ne contient pas toute l'information sur les bases qui le compose. On a donc : 
  $$
  \Pr\{(X_{n+1}, Y_{n+1}, Z_{n+1}) = (x, y, z) \mid \{(X_t, Y_t, Z_t)\}_{t \leq n}\}
  =
  \Pr\{(X_{n+1}, Y_{n+1}, Z_{n+1}) = (x, y, z) \mid (X_n, Y_n, Z_n)\}
  $$
  et donc
  $$
  \Pr\{f(X_{n+1}, Y_{n+1}, Z_{n+1}) = a \mid \{(X_t, Y_t, Z_t)\}_{t \leq n}\}
  =
  \Pr\{f(X_{n+1}, Y_{n+1}, Z_{n+1}) = a \mid (X_n, Y_n, Z_n)\}
  $$
  mais pas
  $$
  \Pr\{f(X_{n+1}, Y_{n+1}, Z_{n+1}) = a \mid \{f(X_t, Y_t, Z_t)\}_{t \leq n}\}
  \neq
  \Pr\{f(X_{n+1}, Y_{n+1}, Z_{n+1}) = a \mid f(X_n, Y_n, Z_n)\}
  $$
  }
  %
\end{enumerate}

